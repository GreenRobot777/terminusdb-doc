<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Importing and Cleaning Data From CSVs - Graph Database Documentation</title><link rel="shortcut icon" href="/docs/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/docs/assets/css/just-the-docs.css"><link href="https://fonts.googleapis.com/css?family=Lexend+Deca&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Poppins&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.9/css/all.css" integrity="sha384-5SOiIsAziJl6AWe0HWRKTXlfcSHKmYV4RBF18PPJ173Kzn7jzMyFuTtk8JA7QQG1" crossorigin="anonymous"> <script type="text/javascript" src="/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Importing and Cleaning Data From CSVs | Graph Database Documentation</title><meta name="generator" content="Jekyll v3.8.7" /><meta property="og:title" content="Importing and Cleaning Data From CSVs" /><meta property="og:locale" content="en_US" /><meta name="description" content="TerminusDB - Quick start tutorials and how to’s for the graph database management system" /><meta property="og:description" content="TerminusDB - Quick start tutorials and how to’s for the graph database management system" /><link rel="canonical" href="/docs/tutorials/csv-tutorial/" /><meta property="og:url" content="/docs/tutorials/csv-tutorial/" /><meta property="og:site_name" content="Graph Database Documentation" /> <script type="application/ld+json"> {"description":"TerminusDB - Quick start tutorials and how to’s for the graph database management system","@type":"WebPage","url":"/docs/tutorials/csv-tutorial/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://terminusdb.com/img/logos/logo.svg"}},"headline":"Importing and Cleaning Data From CSVs","@context":"https://schema.org"}</script> <script async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script> <noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt=""/></noscript> <script> var _paq = window._paq || []; /* tracker methods like "setCustomDimension" should be called before "trackPageView" */ _paq.push(['disableCookies']); _paq.push(['trackPageView']); _paq.push(['enableLinkTracking']); (function() { var u="https://terminusdb.matomo.cloud/"; _paq.push(['setTrackerUrl', u+'matomo.php']); _paq.push(['setSiteId', '1']); var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript'; g.async=true; g.defer=true; g.src='//cdn.matomo.cloud/terminusdb.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s); })(); </script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"><title>Link</title><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg><div class="page-wrap"><div class="side-bar"><div class="site-header"> <a href="https://terminusdb.com" class="site-title lh-tight"><div class="site-logo"></div></a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button></div><div class="navigation main-nav js-main-nav"><nav role="navigation" aria-label="Main navigation"><ul class="navigation-list"><li class="navigation-list-item active"> <a href="https://terminusdb.com/documentation" class="navigation-list-link active">Home</a><li class="navigation-list-item active"><li class="navigation-list-item"><a href="/docs/quickstart/" class="navigation-list-link">Quickstart Academy</a><li class="navigation-list-item"><a href="/docs/tutorials" class="navigation-list-link">Graph Database Tutorials - TerminusDB Documentation</a><ul class="navigation-list-child-list "></ul><li class="navigation-list-item"><a href="/docs/reference/" class="navigation-list-link">Reference</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/reference/server" class="navigation-list-link">Server</a><li class="navigation-list-item "><a href="/docs/reference/js-client/" class="navigation-list-link">JS Client</a><li class="navigation-list-item "><a href="/docs/reference/python-client/" class="navigation-list-link">Python Client</a><li class="navigation-list-item "><a href="/docs/reference/bootstrap" class="navigation-list-link">Bootstrap</a><li class="navigation-list-item "><a href="/docs/reference/web-components" class="navigation-list-link">Console</a><li class="navigation-list-item "><a href="/docs/reference/woql" class="navigation-list-link">WOQL.js - the Definitive Guide</a></ul><li class="navigation-list-item"><a href="/docs/how-tos" class="navigation-list-link">How To's for Graph Database</a><ul class="navigation-list-child-list "></ul><li class="navigation-list-item"><a href="/docs/discussion" class="navigation-list-link">Graph database management discussion</a><ul class="navigation-list-child-list "></ul><li class="navigation-list-item"><a href="/docs/release-notes/" class="navigation-list-link">Release notes</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/release-notes/upgrade/" class="navigation-list-link">Upgrade</a></ul><li class="navigation-list-item"><a href="/docs/frequently-asked-questions/" class="navigation-list-link">FAQs</a></ul></nav></div><footer class="site-footer"><p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p></footer></div><div class="main-content-wrap js-main-content" tabindex="0"><div class="main-content"><div class="page-header js-page-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Graph Database Documentation" aria-label="Search Graph Database Documentation" autocomplete="off"> <label for="search-input" class="search-label"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </label></div><div id="search-results" class="search-results"></div></div></div><header class="header header--dark"><div class="wrapper wrapper--increased"><nav class="menu"><div class="menu__body"><ul class="menu__list"><li class="menu__item"> <a href="https://terminusdb.com/documentation/" target="_self" class="menu__link menu__link--active" aria-label="Documentation"> Documentation </a><li class="menu__item"> <a href="https://terminusdb.com/community/" target="_self" class="menu__link " aria-label="Community"> Community </a><li class="menu__item"> <a href="https://terminusdb.com/blog/" target="_self" class="menu__link" aria-label="Blog"> Blog </a><li class="menu__item"> <a href="https://terminusdb.com/hub/" target="_self" class="menu__link" aria-label="Blog"> Terminus Hub </a><li class="menu__item menu__item--full-devices"><ul class="menu__social-list"><li class="menu__social-item"> <a href="https://twitter.com/TerminusDB" class="menu__social-link" target="_blank"> <i class="icon-twitter menu__icon"></i> </a><li class="menu__social-item"> <a href="https://github.com/terminusdb/terminusdb-server" class="menu__social-link" target="_blank" aria-label="Github link"> <i class="icon-github-logo menu__icon"></i> </a><li class="menu__social-item"><a href="https://www.youtube.com/channel/UC5kZt8pP-FM0u-R0BQr78YA/featured" class="menu__social-link" target="_blank"><i class="icon-youtube menu__icon"></i></a><li class="menu__social-item"><a href="https://www.linkedin.com/company/terminusdb/" class="menu__social-link" target="_blank"><i class="icon-linkedin menu__icon"></i></a></ul><li class="menu__item menu__item--full-devices"> <a href="https://terminusdb.com/hub/download" target="_self" class="menu__button" aria-label="Download center"> Download Center </a></ul><ul class="menu__footer"><li class="menu__secondary-item"> <a href="https://terminusdb.com" role="button"> <img src="https://terminusdb.com/img/logos/logo.svg" class="menu__secondary-logo" alt="Terminus DB logo"> </a><li class="menu__secondary-item"><p class="menu__copyright"> ©2020 - TerminusDB | All right reserved</p></ul></div><button id="burger" class="menu__burger" role="button" aria-label="Navigation burger button"> <span></span> <span></span> <span></span> </button></nav></div></header><div class="page"><nav class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/docs/">Tutorials</a><li class="breadcrumb-nav-list-item"><span>Importing and Cleaning Data From CSVs</span></ol></nav><div id="main-content" class="page-content" role="main"><h1 class="no_toc" id="importing-and-cleaning-data-from-csvs"> <a href="#importing-and-cleaning-data-from-csvs" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Importing and Cleaning Data from CSVs</h1><p>In this tutorial, we will learn how to load data from a CSV file then clean it up with some data wrangling, like changing the type of the data, combining strings and generating ids for objects.</p><h2 class="no_toc text-delta" id="jump-to"> <a href="#jump-to" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Jump to</h2><ol id="markdown-toc"><li><a href="#step-1---reading-the-csv-columns" id="markdown-toc-step-1---reading-the-csv-columns">Step 1 - reading the CSV columns</a><li><a href="#step-2---data-wrangling" id="markdown-toc-step-2---data-wrangling">Step 2 - data wrangling</a><li><a href="#step-3---insert-data" id="markdown-toc-step-3---insert-data">Step 3 - insert data</a></ol><hr /><h2 id="step-1---reading-the-csv-columns"> <a href="#step-1---reading-the-csv-columns" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Step 1 - reading the CSV columns</h2><p>In our example, we will try to load data from this CSV: <a href="https://terminusdb.com/t/data/bike_tutorial.csv">https://terminusdb.com/t/data/bike_tutorial.csv</a></p><p>This can be done by making woql queries. In this tutorial, we will be making queries in the TerminusDB console. However, you can also do it with TerminusDB clients.</p><p>To make a query in the console, go to the query tab by clicking on <code class="highlighter-rouge">query</code> at the top.</p><p><img src="/docs/assets/images/tutorials/console-query-page.png" alt="console query page" /></p><p>Now it’s time for the query. Our first step is to load in each column as a woql variable. This can be done with the following script:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Member type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Member_Type</span><span class="dl">"</span><span class="p">)</span>
<span class="p">).</span><span class="nx">remote</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://terminusdb.com/t/data/bike_tutorial.csv</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div><p>This script involves <code class="highlighter-rouge">get</code>, <code class="highlighter-rouge">as</code> and <code class="highlighter-rouge">remote</code> method. For more explanation about these methods, please see their reference in woql.</p><p>This is loading a remote CSV from the link. For loading a local file, please see the reference of <code class="highlighter-rouge">file</code> method.</p><p>If you click <code class="highlighter-rouge">run query</code> now, you will see the CSV is imported and the result is shown in a tabular format.</p><p><img src="/docs/assets/images/tutorials/read-csv.png" alt="read csv" /></p><p>You can switch back to the Query tab by clicking on <code class="highlighter-rouge">Query</code> next to <code class="highlighter-rouge">Result Viewer</code> on top of the results.</p><p>However, the data read in this step is not updated in any graphs. To save the data in the graph, we will assign this query to a variable and combine it with the following steps.</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">csv</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Member type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Member_Type</span><span class="dl">"</span><span class="p">)</span>
<span class="p">).</span><span class="nx">remote</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://terminusdb.com/t/data/bike_tutorial.csv</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div><h2 id="step-2---data-wrangling"> <a href="#step-2---data-wrangling" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Step 2 - data wrangling</h2><p>In the next step, we are going to prepare the data for step 3. The data that we got in step 1 is not ready to be put in the graph. We will have to generate an id for doctype objects, convert data to their correct data types and create strings for labels and descriptions.</p><p>To do that, we will expand our previous script as follows:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">csv</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Member type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Member_Type</span><span class="dl">"</span><span class="p">)</span>
<span class="p">).</span><span class="nx">remote</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://terminusdb.com/t/data/bike_tutorial.csv</span><span class="dl">"</span><span class="p">)</span>
<span class="c1">//Transform data into correct shape for insert</span>
<span class="kd">const</span> <span class="nx">wrangles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:integer</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:dateTime</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ST_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:dateTime</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ET_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:SS_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ES_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Journey</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Journey_ID</span><span class="dl">"</span><span class="p">),</span>       
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Station</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Station</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Bicycle</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">),</span>    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_ID - v:End_ID @ v:Start_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:J_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike v:Bike from v:Start_Station to v:End_Station at v:Start_Time until v:End_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Journey_Description</span><span class="dl">"</span><span class="p">)</span>
<span class="p">];</span>
<span class="c1">//Combine with logical and</span>
<span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">csv</span><span class="p">,</span> <span class="p">...</span><span class="nx">wrangles</span><span class="p">)</span>
</code></pre></div></div><p>For explanations about the <code class="highlighter-rouge">idgen</code>, <code class="highlighter-rouge">typecast</code> and <code class="highlighter-rouge">concat</code> methods that are used in the data wrangling, please see their reference in woql.</p><p>If you click <code class="highlighter-rouge">run query</code> now, you will see that we have got new variables that have been created with the data wrangling. However, the data is not loaded in the graph yet.</p><p><img src="/docs/assets/images/tutorials/data-wrangling.png" alt="data wrangling" /></p><h2 id="step-3---insert-data"> <a href="#step-3---insert-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Step 3 - insert data</h2><p>For the last step, we will insert the data that we prepared into the graph. The whole script that includes this step and the previous steps is here:</p><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">csv</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End date</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Start station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">End station number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike number</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">as</span><span class="p">(</span><span class="dl">"</span><span class="s2">Member type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Member_Type</span><span class="dl">"</span><span class="p">)</span>
<span class="p">).</span><span class="nx">remote</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://terminusdb.com/t/data/bike_tutorial.csv</span><span class="dl">"</span><span class="p">)</span>
<span class="c1">//Clean data for insert</span>
<span class="kd">const</span> <span class="nx">wrangles</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:integer</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:dateTime</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ST_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:dateTime</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ET_Cast</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:SS_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">typecast</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ES_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Journey</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Start_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Bike</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Journey_ID</span><span class="dl">"</span><span class="p">),</span>       
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Station</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Start_ID</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Station</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:End_ID</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">idgen</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:Bicycle</span><span class="dl">"</span><span class="p">,[</span><span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">],</span><span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">),</span>    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_ID - v:End_ID @ v:Start_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:J_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bike v:Bike from v:Start_Station to v:End_Station at v:Start_Time until v:End_Time</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">v:Journey_Description</span><span class="dl">"</span><span class="p">)</span>
<span class="p">];</span>
<span class="c1">//combine inputs</span>
<span class="kd">const</span> <span class="nx">inputs</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">csv</span><span class="p">,</span> <span class="p">...</span><span class="nx">wrangles</span><span class="p">)</span>
<span class="c1">//generate data to be inserted</span>
<span class="kd">const</span> <span class="nx">inserts</span> <span class="o">=</span> <span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey_ID</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Journey</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:J_Label</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Journey_Description</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ST_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_time</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:ET_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">duration</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Duration_Cast</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">start_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">end_station</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">journey_bicycle</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Start_Station_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:SS_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:End_Station_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Station</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:ES_Label</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike_URL</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Bicycle</span><span class="dl">"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">v:Bike_Label</span><span class="dl">"</span><span class="p">)</span>
<span class="p">);</span>
<span class="c1">//Combine inputs and inserts with when clause</span>
<span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span><span class="nx">inputs</span><span class="p">,</span> <span class="nx">inserts</span><span class="p">);</span>
</code></pre></div></div><p>For details about how <code class="highlighter-rouge">insert</code> works, please refer to the woql reference.</p><p>As this time we are updating the graph, we can put in a commit message (e.g. Insert data form CSV) in the box above the query which says “Enter reason for update here” before we hit <code class="highlighter-rouge">run query</code>. If there’s no commit message given, a default message will be used as a commit message.</p><p><img src="/docs/assets/images/tutorials/commit-message.png" alt="commit message" /></p><p>After clicking <code class="highlighter-rouge">run query</code>, you will now see the message in the green box saying “Successfully updated database”.</p><p><img src="/docs/assets/images/tutorials/update-success.png" alt="update success" /></p><p>Now you can check that the data has been added by clicking on <code class="highlighter-rouge">Documents</code> at the top.</p><p><img src="/docs/assets/images/tutorials/documents.png" alt="documents" /></p><hr><footer role="contentinfo"><p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 - TerminusDB | Distributed by an <a href="https://github.com/terminusdb/terminusdb-server/blob/master/LICENSE">GPL-3.0 license.</a></p></footer></div></div></div></div><script> var o = document.querySelector(".header"), i = document.querySelector(".menu__body"), a = document.querySelector("#burger"); a && a.addEventListener("click", function () { a.classList.toggle("active"), o.classList.toggle("active"), i.classList.toggle("active"); }); window.addEventListener('resize',function(){ a.classList.remove("active"), o.classList.remove("active"), i.classList.remove("active"); }) </script>
