<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Creating and Merging Branches - TerminusDB Documentation</title><link rel="shortcut icon" href="/docs/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/docs/assets/css/just-the-docs.css"><link href="https://fonts.googleapis.com/css?family=Lexend+Deca&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Poppins&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.9/css/all.css" integrity="sha384-5SOiIsAziJl6AWe0HWRKTXlfcSHKmYV4RBF18PPJ173Kzn7jzMyFuTtk8JA7QQG1" crossorigin="anonymous"> <script type="text/javascript" src="/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Creating and Merging Branches | TerminusDB Documentation</title><meta name="generator" content="Jekyll v3.8.7" /><meta property="og:title" content="Creating and Merging Branches" /><meta property="og:locale" content="en_US" /><meta name="description" content="Documentation for TerminusDB" /><meta property="og:description" content="Documentation for TerminusDB" /><link rel="canonical" href="/docs/tutorials/branch-tutorial/" /><meta property="og:url" content="/docs/tutorials/branch-tutorial/" /><meta property="og:site_name" content="TerminusDB Documentation" /> <script type="application/ld+json"> {"description":"Documentation for TerminusDB","@type":"WebPage","url":"/docs/tutorials/branch-tutorial/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://terminusdb.com/img/logos/logo.svg"}},"headline":"Creating and Merging Branches","@context":"https://schema.org"}</script> <script async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script> <noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt=""/></noscript> <script> var _paq = window._paq || []; /* tracker methods like "setCustomDimension" should be called before "trackPageView" */ _paq.push(['disableCookies']); _paq.push(['trackPageView']); _paq.push(['enableLinkTracking']); (function() { var u="https://terminusdb.matomo.cloud/"; _paq.push(['setTrackerUrl', u+'matomo.php']); _paq.push(['setSiteId', '1']); var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript'; g.async=true; g.defer=true; g.src='//cdn.matomo.cloud/terminusdb.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s); })(); </script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"><title>Link</title><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg><div class="page-wrap"><div class="side-bar"><div class="site-header"> <a href="https://terminusdb.com" class="site-title lh-tight"><div class="site-logo"></div></a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button></div><div class="navigation main-nav js-main-nav"><nav role="navigation" aria-label="Main navigation"><ul class="navigation-list"><li class="navigation-list-item active"> <a href="https://terminusdb.com/documentation" class="navigation-list-link active">Home</a><li class="navigation-list-item active"><li class="navigation-list-item"><a href="/docs/quickstart/" class="navigation-list-link">Quickstart Academy</a><li class="navigation-list-item active"><a href="/docs/tutorials" class="navigation-list-link">Tutorials</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/tutorials/clone-tutorial/" class="navigation-list-link">My First Cloned Database</a><li class="navigation-list-item "><a href="/docs/tutorials/share-tutorial/" class="navigation-list-link">My First Shared Database</a><li class="navigation-list-item "><a href="/docs/tutorials/push-pull-tutorial/" class="navigation-list-link">Pushing and Pulling Changes</a><li class="navigation-list-item active"><a href="/docs/tutorials/branch-tutorial/" class="navigation-list-link active">Creating and Merging Branches</a><li class="navigation-list-item "><a href="/docs/tutorials/knowledge-graph/" class="navigation-list-link">Taking TerminusDB to the Bank</a><li class="navigation-list-item "><a href="/docs/tutorials/csv-tutorial/" class="navigation-list-link">Importing and Cleaning Data From CSVs</a></ul><li class="navigation-list-item"><a href="/docs/reference/" class="navigation-list-link">Reference</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/reference/server" class="navigation-list-link">Server</a><li class="navigation-list-item "><a href="/docs/reference/js-client/" class="navigation-list-link">JS Client</a><li class="navigation-list-item "><a href="/docs/reference/python-client/" class="navigation-list-link">Python Client</a><li class="navigation-list-item "><a href="/docs/reference/bootstrap" class="navigation-list-link">Bootstrap</a><li class="navigation-list-item "><a href="/docs/reference/web-components" class="navigation-list-link">Console</a><li class="navigation-list-item "><a href="/docs/reference/woql" class="navigation-list-link">WOQL.js - the Definitive Guide</a></ul><li class="navigation-list-item"><a href="/docs/how-tos" class="navigation-list-link">How Tos</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/how-tos/installation/" class="navigation-list-link">Installation</a><li class="navigation-list-item "><a href="/docs/how-tos/other-install/" class="navigation-list-link">Other ways of installing TerminusDB</a><li class="navigation-list-item "><a href="/docs/how-tos/manage-collaborators/" class="navigation-list-link">Manage Collaborators</a><li class="navigation-list-item "><a href="/docs/how-tos/synchronise/" class="navigation-list-link">Synchronising Changes</a><li class="navigation-list-item "><a href="/docs/how-tos/time-travel/" class="navigation-list-link">Time Travel</a><li class="navigation-list-item "><a href="/docs/how-tos/branch/" class="navigation-list-link">Create and Merge Branches</a><li class="navigation-list-item "><a href="/docs/how-tos/import-data/" class="navigation-list-link">Import and Clean CSV Data</a><li class="navigation-list-item "><a href="/docs/how-tos/query/" class="navigation-list-link">Query</a><li class="navigation-list-item "><a href="/docs/how-tos/schema/" class="navigation-list-link">Create Schema</a><li class="navigation-list-item "><a href="/docs/how-tos/python" class="navigation-list-link">Python How Tos</a><li class="navigation-list-item "><a href="/docs/how-tos/beta/" class="navigation-list-link">Accessing TerminusHub with Bootstrap - Certificate Help</a></ul><li class="navigation-list-item"><a href="/docs/discussion" class="navigation-list-link">Discussion</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/discussion/baisc/" class="navigation-list-link">Basic Ideas</a><li class="navigation-list-item "><a href="/docs/discussion/collaboration/" class="navigation-list-link">Collaboration</a><li class="navigation-list-item "><a href="/docs/discussion/branch/" class="navigation-list-link">Branching and Merging</a><li class="navigation-list-item "><a href="/docs/discussion/storage/" class="navigation-list-link">Storage</a><li class="navigation-list-item "><a href="/docs/discussion/data-model/" class="navigation-list-link">Data Modeling</a><li class="navigation-list-item "><a href="/docs/discussion/query/" class="navigation-list-link">Querying</a><li class="navigation-list-item "><a href="/docs/discussion/reserach/" class="navigation-list-link">Research Papers</a></ul><li class="navigation-list-item"><a href="/docs/release-notes/" class="navigation-list-link">Release notes</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/release-notes/upgrade/" class="navigation-list-link">Upgrade</a></ul><li class="navigation-list-item"><a href="/docs/frequently-asked-questions/" class="navigation-list-link">FAQs</a></ul></nav></div><footer class="site-footer"><p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p></footer></div><div class="main-content-wrap js-main-content" tabindex="0"><div class="main-content"><div class="page-header js-page-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search TerminusDB Documentation" aria-label="Search TerminusDB Documentation" autocomplete="off"> <label for="search-input" class="search-label"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </label></div><div id="search-results" class="search-results"></div></div></div><header class="header header--dark"><div class="wrapper wrapper--increased"><nav class="menu"><div class="menu__body"><ul class="menu__list"><li class="menu__item"> <a href="https://terminusdb.com/documentation/" target="_self" class="menu__link menu__link--active" aria-label="Documentation"> Documentation </a><li class="menu__item"> <a href="https://terminusdb.com/community/" target="_self" class="menu__link " aria-label="Community"> Community </a><li class="menu__item"> <a href="https://terminusdb.com/blog/" target="_self" class="menu__link" aria-label="Blog"> Blog </a><li class="menu__item"> <a href="https://terminusdb.com/hub/" target="_self" class="menu__link" aria-label="Blog"> Terminus Hub </a><li class="menu__item menu__item--full-devices"><ul class="menu__social-list"><li class="menu__social-item"> <a href="https://twitter.com/TerminusDB" class="menu__social-link" target="_blank"> <i class="icon-twitter menu__icon"></i> </a><li class="menu__social-item"> <a href="https://github.com/terminusdb/terminusdb-server" class="menu__social-link" target="_blank" aria-label="Github link"> <i class="icon-github-logo menu__icon"></i> </a><li class="menu__social-item"><a href="https://www.youtube.com/channel/UC5kZt8pP-FM0u-R0BQr78YA/featured" class="menu__social-link" target="_blank"><i class="icon-youtube menu__icon"></i></a><li class="menu__social-item"><a href="https://www.linkedin.com/company/terminusdb/" class="menu__social-link" target="_blank"><i class="icon-linkedin menu__icon"></i></a></ul><li class="menu__item menu__item--full-devices"> <a href="https://terminusdb.com/hub/download" target="_self" class="menu__button" aria-label="Download center"> Download Center </a></ul><ul class="menu__footer"><li class="menu__secondary-item"> <a href="https://terminusdb.com" role="button"> <img src="https://terminusdb.com/img/logos/logo.svg" class="menu__secondary-logo" alt="Terminus DB logo"> </a><li class="menu__secondary-item"><p class="menu__copyright"> ©2020 - TerminusDB | All right reserved</p></ul></div><button id="burger" class="menu__burger" role="button" aria-label="Navigation burger button"> <span></span> <span></span> <span></span> </button></nav></div></header><div class="page"><nav class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/docs/tutorials">Tutorials</a><li class="breadcrumb-nav-list-item"><span>Creating and Merging Branches</span></ol></nav><div id="main-content" class="page-content" role="main"><h1 id="create-and-merge-branches"> <a href="#create-and-merge-branches" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Create and Merge Branches</h1><p class="no_toc">TerminusDB is designed to enable collaboration and revision control on data assets. While git is a fantastic piece of software, it is designed for code management, and not data management. We bring that power to the world of data.</p><p>In order to get a feel for how these collaboration features work, we can start with a classic database management problem: the bank account balance.</p><p>This tutorial will show you how to use the branch and merge functions in TerminusDB.</p><iframe width="560" height="315" src="https://www.youtube.com/embed/YY1usMBuNSU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><hr /><h2 id="section-1---schema-and-data"> <a href="#section-1---schema-and-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Section 1 - Schema and Data</h2><p>Create a new database with the ID <code class="highlighter-rouge">banker</code> and the name “bank”, in the console. Select ‘Create on TerminusHub’.</p><p><img src="/docs/assets/uploads/bank-create.jpg" alt="" /></p><p>Once created you should land in the DB Home page.</p><p>The first thing we need to do is define a data model. To do this, click on the Query button at the top and enter the following query, along with a comment “New schema”.</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WOQL.doctype("BankAccount").label("Bank Account")
    .property("owner","xsd:string")
       .label("owner")
       .cardinality(1)
    .property("balance","xsd:nonNegativeInteger")
       .label("balance")
       .cardinality(1)
</code></pre></div></div><p>This query creates a new document type “BankAccount” along with two properties, one named “owner” which is a string, and one named balance. Both have a cardinality of 1.</p><p><img src="/docs/assets/uploads/new-schema.jpg" alt="" /></p><p>If you click on the “Bank Balance Example” button on the top of the screen, it will bring you back to the revision overview and you should be able to see what changes you have made.</p><h3 id="data-entry"> <a href="#data-entry" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Data Entry</h3><p>Ok, so far so good, but we’ve no data. Now it is time to try and put some data in the db.</p><p>Let’s go to the query screen and write the following query:</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WOQL.and(
  WOQL.add_triple("doc:mike", "type", "scm:BankAccount"),
  WOQL.add_triple("doc:mike", "owner", "mike"),
  WOQL.add_triple("doc:mike", "balance", 123)
  )
</code></pre></div></div><p>This adds some data to our database. You can click on the Documents page and you will see, that in fact mike was added.</p><p>Now we should try to make some edits to the bank account to see what happens.</p><p>First, let’s try and subtract 130 dollars from Mike’s account.</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vars = function(sl) {return sl.map( s =&gt; "v:" + s)}
let [balance,new_balance] = vars(["Balance", "New Balance"])
WOQL.and(
  WOQL.triple("doc:mike", "scm:balance", balance),
  WOQL.delete_triple("doc:mike", "scm:balance", balance),
  WOQL.eval(WOQL.minus(balance, 130), new_balance),
  WOQL.add_triple("doc:mike", "scm:balance", new_balance)
)
</code></pre></div></div><p>This query fails with the following JSON-LD witness object:</p><p><img src="/docs/assets/uploads/query-fail.jpg" alt="" /></p><p>This tells us that our bank balance is invalid as it is negative! TerminusDB doesn’t allow the transaction to go through.</p><p>However, we can change the balance by subtracting a smaller number:</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vars = function(sl) {return sl.map( s =&gt; "v:" + s)}
let [balance,new_balance] = vars(["Balance", "New Balance"])
WOQL.and(
  WOQL.triple("doc:mike", "scm:balance", balance),
  WOQL.delete_triple("doc:mike", "scm:balance", balance),
  WOQL.eval(WOQL.minus(balance, 13), new_balance),
  WOQL.add_triple("doc:mike", "scm:balance", new_balance)
)
</code></pre></div></div><p>Press “Query” and see the result:</p><p><img src="/docs/assets/uploads/result.jpg" alt="" /></p><p>Now we have a balance of 13 as expected and everything works fine.</p><hr /><h2 id="section-2---branch-and-merge"> <a href="#section-2---branch-and-merge" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Section 2 - Branch and Merge</h2><h3 id="branching"> <a href="#branching" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Branching</h3><p>Now that we have some data and some updates, we can go ahead and try creating a branch. A branch starts a new database from a particular commit, allowing us to change the database without affecting the original database.</p><p>This can be used to make isolated changes and test them, before we merge them back into the original.</p><p>Ok, so go click on the “Branch” button.</p><p>Under the field “New Branch ID” enter in “branch_office” and we’ll pretend we have a branch office adding accounts.</p><p><img src="/docs/assets/uploads/create-branches-2.jpg" alt="" /></p><p>Now go to the query page. If you look up at the top right of the interface, you’ll see we are still on “branch: main”. Pull the selector down to “branch: branch_office”.</p><p>Now we can enter the following query:</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WOQL.and(
  WOQL.add_triple("doc:jim", "type", "scm:BankAccount"),
  WOQL.add_triple("doc:jim", "owner", "jim"),
  WOQL.add_triple("doc:jim", "balance", 8)
  )
</code></pre></div></div><p>This creates Jim, with all 8 dollars to his name. If we now go to the Documents tab we can see that Jim and Mike’s bank account are both listed now.</p><p><img src="/docs/assets/uploads/branch-office.jpg" alt="" /></p><h3 id="rebase"> <a href="#rebase" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Rebase</h3><p>Let’s go back to the original branch (main), by selecting it in the upper right hand corner, and add one more person, jane in the main branch so that we now have two different histories, with one common commit.</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WOQL.and(
  WOQL.add_triple("doc:jane", "type", "scm:BankAccount"),
  WOQL.add_triple("doc:jane", "owner", "jane"),
  WOQL.add_triple("doc:jane", "balance", 887)
  )
</code></pre></div></div><p>Jane was a bit more frugal and has saved 887 dollars.</p><p><img src="/docs/assets/uploads/main-branch.jpg" alt="" /></p><p>But we’re still missing the information about jim, as it’s stuck in the branch office. How do we get the information into our main branch?</p><p>This is why we have merge. Click the “Branch” button and click on Merge.</p><p><img src="/docs/assets/uploads/create-branches.jpg" alt="" /></p><p>Select the “branch_office” branch in the upper right hand corner. Now select the “merge into” branch as “main”.</p><p><img src="/docs/assets/uploads/merge-screen.jpg" alt="" /></p><p>Now we should go back to the main branch (again in the upper right hand corner), and select the documents view. You’ll see that we have merged the two databases together!</p><p><img src="/docs/assets/uploads/post-merge.jpg" alt="" /></p><p>That’s how easy it is to manage complex data with TerminusDB and TerminusHub.</p><hr><footer role="contentinfo"><p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 - TerminusDB | Distributed by an <a href="https://github.com/terminusdb/terminusdb-server/blob/master/LICENSE">GPL-3.0 license.</a></p></footer></div></div></div></div><script> var o = document.querySelector(".header"), i = document.querySelector(".menu__body"), a = document.querySelector("#burger"); a && a.addEventListener("click", function () { a.classList.toggle("active"), o.classList.toggle("active"), i.classList.toggle("active"); }); window.addEventListener('resize',function(){ a.classList.remove("active"), o.classList.remove("active"), i.classList.remove("active"); }) </script>
