<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Query - Graph Database Documentation</title><link rel="shortcut icon" href="/docs/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/docs/assets/css/just-the-docs.css"><link href="https://fonts.googleapis.com/css?family=Lexend+Deca&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Poppins&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.9/css/all.css" integrity="sha384-5SOiIsAziJl6AWe0HWRKTXlfcSHKmYV4RBF18PPJ173Kzn7jzMyFuTtk8JA7QQG1" crossorigin="anonymous"> <script type="text/javascript" src="/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Query | Graph Database Documentation</title><meta name="generator" content="Jekyll v3.8.7" /><meta property="og:title" content="Query" /><meta property="og:locale" content="en_US" /><meta name="description" content="TerminusDB - Quick start tutorials and how to’s for the graph database management system" /><meta property="og:description" content="TerminusDB - Quick start tutorials and how to’s for the graph database management system" /><link rel="canonical" href="/docs/how-tos/query/" /><meta property="og:url" content="/docs/how-tos/query/" /><meta property="og:site_name" content="Graph Database Documentation" /> <script type="application/ld+json"> {"description":"TerminusDB - Quick start tutorials and how to’s for the graph database management system","@type":"WebPage","url":"/docs/how-tos/query/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://terminusdb.com/img/logos/logo.svg"}},"headline":"Query","@context":"https://schema.org"}</script> <script async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script> <noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt=""/></noscript> <script> var _paq = window._paq || []; /* tracker methods like "setCustomDimension" should be called before "trackPageView" */ _paq.push(['disableCookies']); _paq.push(['trackPageView']); _paq.push(['enableLinkTracking']); (function() { var u="https://terminusdb.matomo.cloud/"; _paq.push(['setTrackerUrl', u+'matomo.php']); _paq.push(['setSiteId', '1']); var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript'; g.async=true; g.defer=true; g.src='//cdn.matomo.cloud/terminusdb.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s); })(); </script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"><title>Link</title><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg><div class="page-wrap"><div class="side-bar"><div class="site-header"> <a href="https://terminusdb.com" class="site-title lh-tight"><div class="site-logo"></div></a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button></div><div class="navigation main-nav js-main-nav"><nav role="navigation" aria-label="Main navigation"><ul class="navigation-list"><li class="navigation-list-item active"> <a href="https://terminusdb.com/documentation" class="navigation-list-link active">Home</a><li class="navigation-list-item active"><li class="navigation-list-item"><a href="/docs/quickstart/" class="navigation-list-link">Quickstart Academy</a><li class="navigation-list-item"><a href="/docs/tutorials" class="navigation-list-link">Graph Database Tutorials - TerminusDB Documentation</a><ul class="navigation-list-child-list "></ul><li class="navigation-list-item"><a href="/docs/reference/" class="navigation-list-link">Reference</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/reference/server" class="navigation-list-link">Server</a><li class="navigation-list-item "><a href="/docs/reference/js-client/" class="navigation-list-link">JS Client</a><li class="navigation-list-item "><a href="/docs/reference/python-client/" class="navigation-list-link">Python Client</a><li class="navigation-list-item "><a href="/docs/reference/bootstrap" class="navigation-list-link">Bootstrap</a><li class="navigation-list-item "><a href="/docs/reference/web-components" class="navigation-list-link">Console</a><li class="navigation-list-item "><a href="/docs/reference/woql" class="navigation-list-link">WOQL.js - the Definitive Guide</a></ul><li class="navigation-list-item active"><a href="/docs/how-tos" class="navigation-list-link">How Tos</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/how-tos/installation/" class="navigation-list-link">Installation</a><li class="navigation-list-item "><a href="/docs/how-tos/other-install/" class="navigation-list-link">Other ways of installing TerminusDB</a><li class="navigation-list-item "><a href="/docs/how-tos/manage-collaborators/" class="navigation-list-link">Manage Collaborators</a><li class="navigation-list-item "><a href="/docs/how-tos/synchronise/" class="navigation-list-link">Synchronising Changes</a><li class="navigation-list-item "><a href="/docs/how-tos/time-travel/" class="navigation-list-link">Time Travel</a><li class="navigation-list-item "><a href="/docs/how-tos/branch/" class="navigation-list-link">Create and Merge Branches</a><li class="navigation-list-item "><a href="/docs/how-tos/import-data/" class="navigation-list-link">Import and Clean CSV Data</a><li class="navigation-list-item active"><a href="/docs/how-tos/query/" class="navigation-list-link active">Query</a><li class="navigation-list-item "><a href="/docs/how-tos/schema/" class="navigation-list-link">Create Schema</a><li class="navigation-list-item "><a href="/docs/how-tos/python" class="navigation-list-link">Python How Tos</a><li class="navigation-list-item "><a href="/docs/how-tos/beta/" class="navigation-list-link">Accessing TerminusHub with Bootstrap - Certificate Help</a></ul><li class="navigation-list-item"><a href="/docs/discussion" class="navigation-list-link">Discussion</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/discussion/baisc/" class="navigation-list-link">Basic Ideas</a><li class="navigation-list-item "><a href="/docs/discussion/collaboration/" class="navigation-list-link">Collaboration</a><li class="navigation-list-item "><a href="/docs/discussion/branch/" class="navigation-list-link">Branching and Merging</a><li class="navigation-list-item "><a href="/docs/discussion/storage/" class="navigation-list-link">Storage</a><li class="navigation-list-item "><a href="/docs/discussion/data-model/" class="navigation-list-link">Data Modeling</a><li class="navigation-list-item "><a href="/docs/discussion/query/" class="navigation-list-link">Querying</a><li class="navigation-list-item "><a href="/docs/discussion/reserach/" class="navigation-list-link">Research Papers</a></ul><li class="navigation-list-item"><a href="/docs/release-notes/" class="navigation-list-link">Release notes</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/release-notes/upgrade/" class="navigation-list-link">Upgrade</a></ul><li class="navigation-list-item"><a href="/docs/frequently-asked-questions/" class="navigation-list-link">FAQs</a></ul></nav></div><footer class="site-footer"><p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p></footer></div><div class="main-content-wrap js-main-content" tabindex="0"><div class="main-content"><div class="page-header js-page-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Graph Database Documentation" aria-label="Search Graph Database Documentation" autocomplete="off"> <label for="search-input" class="search-label"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </label></div><div id="search-results" class="search-results"></div></div></div><header class="header header--dark"><div class="wrapper wrapper--increased"><nav class="menu"><div class="menu__body"><ul class="menu__list"><li class="menu__item"> <a href="https://terminusdb.com/documentation/" target="_self" class="menu__link menu__link--active" aria-label="Documentation"> Documentation </a><li class="menu__item"> <a href="https://terminusdb.com/community/" target="_self" class="menu__link " aria-label="Community"> Community </a><li class="menu__item"> <a href="https://terminusdb.com/blog/" target="_self" class="menu__link" aria-label="Blog"> Blog </a><li class="menu__item"> <a href="https://terminusdb.com/hub/" target="_self" class="menu__link" aria-label="Blog"> Terminus Hub </a><li class="menu__item menu__item--full-devices"><ul class="menu__social-list"><li class="menu__social-item"> <a href="https://twitter.com/TerminusDB" class="menu__social-link" target="_blank"> <i class="icon-twitter menu__icon"></i> </a><li class="menu__social-item"> <a href="https://github.com/terminusdb/terminusdb-server" class="menu__social-link" target="_blank" aria-label="Github link"> <i class="icon-github-logo menu__icon"></i> </a><li class="menu__social-item"><a href="https://www.youtube.com/channel/UC5kZt8pP-FM0u-R0BQr78YA/featured" class="menu__social-link" target="_blank"><i class="icon-youtube menu__icon"></i></a><li class="menu__social-item"><a href="https://www.linkedin.com/company/terminusdb/" class="menu__social-link" target="_blank"><i class="icon-linkedin menu__icon"></i></a></ul><li class="menu__item menu__item--full-devices"> <a href="https://terminusdb.com/hub/download" target="_self" class="menu__button" aria-label="Download center"> Download Center </a></ul><ul class="menu__footer"><li class="menu__secondary-item"> <a href="https://terminusdb.com" role="button"> <img src="https://terminusdb.com/img/logos/logo.svg" class="menu__secondary-logo" alt="Terminus DB logo"> </a><li class="menu__secondary-item"><p class="menu__copyright"> ©2020 - TerminusDB | All right reserved</p></ul></div><button id="burger" class="menu__burger" role="button" aria-label="Navigation burger button"> <span></span> <span></span> <span></span> </button></nav></div></header><div class="page"><nav class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/docs/how-tos">How Tos</a><li class="breadcrumb-nav-list-item"><span>Query</span></ol></nav><div id="main-content" class="page-content" role="main"><h1 class="no_toc" id="query"> <a href="#query" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Query</h1><p>TerminusDB allows you to query graphs in either Javascript or Python. This tutorial is about using Javascript, which is the method which is available in the console.</p><h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Table of contents</h2><ol id="markdown-toc"><li><a href="#open-a-database" id="markdown-toc-open-a-database">Open a Database</a><li><a href="#first-steps" id="markdown-toc-first-steps">First steps</a><li><a href="#viewing-the-schema" id="markdown-toc-viewing-the-schema">Viewing the schema</a><li><a href="#combining-queries" id="markdown-toc-combining-queries">Combining Queries</a><li><a href="#manipulating-text" id="markdown-toc-manipulating-text">Manipulating text</a><li><a href="#mathematics" id="markdown-toc-mathematics">Mathematics</a><li><a href="#manipulate-data" id="markdown-toc-manipulate-data">Manipulate Data</a><ol><li><a href="#inserting" id="markdown-toc-inserting">Inserting</a><li><a href="#deleting" id="markdown-toc-deleting">Deleting</a></ol><li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></ol><hr /><h2 class="fs-6 fw-300" id="open-a-database"> <a href="#open-a-database" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Open a Database</h2><p>First you’ll need a database which you can query. You can get started by opening TerminusDB and going to the clone page.</p><p>From there you should select “TerminusDB Bikes Tutorial”, and clone it to your local machine.</p><p>Once you’ve cloned it, you should be opened up into the WordNet database automatically. Click on the Query button.</p><h2 class="fs-6 fw-300" id="first-steps"> <a href="#first-steps" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> First steps</h2><p>Graph databases are made up out of edges in a graph. You can query these edges by using the word <code class="highlighter-rouge">triple</code> (a triple is a source node, a named edge and a target node). Now, the WordNet graph is fairly large, so we’ll also need to limit our queries to make sure we get something manageable to look at. We can do that with <code class="highlighter-rouge">limit</code>.</p><p>Try out the following query in the query box:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">subject</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">,</span> <span class="nx">object</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">subject</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">predicate</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">triple</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span><span class="nx">predicate</span><span class="p">,</span><span class="nx">object</span><span class="p">)</span>
</code></pre></div></div><p>This query just gets back any random edge without any constraints. But graphs are about connections, so we should make a query that goes more than one hop in order to find something interesting. In this case we just get back the triple:</p><div class="table-wrapper"><table><thead><tr><th><code class="highlighter-rouge">X</code><th><code class="highlighter-rouge">P</code><th><code class="highlighter-rouge">Y</code><tbody><tr><td><code class="highlighter-rouge">doc:Bicycle_W00017</code><td><code class="highlighter-rouge">rdf:type</code><td><code class="highlighter-rouge">scm:Bicycle</code></table></div><p>If we want to use the graph aspects, we have to create chains:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">subject</span><span class="p">,</span> <span class="nx">predicate1</span><span class="p">,</span> <span class="nx">intermediate</span><span class="p">,</span> <span class="nx">predicate2</span><span class="p">,</span> <span class="nx">object</span><span class="p">]</span> <span class="o">=</span>
    <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">subject</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">predicate1</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">intermediate</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">predicate2</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">triple</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span><span class="nx">predicate1</span><span class="p">,</span><span class="nx">intermediate</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">triple</span><span class="p">(</span><span class="nx">intermediate</span><span class="p">,</span><span class="nx">predicate2</span><span class="p">,</span><span class="nx">object</span><span class="p">)</span>
</code></pre></div></div><p>This is a two-hop query, so now we are actually exploring the graph a bit.</p><p>First, let’s do a little exploration to see what is in the database. As it turns out, predicates are not as common as source or target nodes (subjects or objects).</p><p>We can see all of the predicates using the following query:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">subject</span><span class="p">,</span> <span class="nx">predicate</span><span class="p">,</span> <span class="nx">object</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">subject</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">predicate</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">object</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">distinct</span><span class="p">(</span><span class="nx">predicate</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="nx">predicate</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">triple</span><span class="p">(</span><span class="nx">subject</span><span class="p">,</span><span class="nx">predicate</span><span class="p">,</span><span class="nx">object</span><span class="p">)</span>
</code></pre></div></div><p>This query selects only the <code class="highlighter-rouge">predicate</code>s (it masks out the other variables) and ensures that we only get distinct <code class="highlighter-rouge">predicate</code>s. You’ll notice that there are two in particular: <code class="highlighter-rouge">scm:start_station</code> and <code class="highlighter-rouge">scm:end_station</code>. We’ll come back to those in a moment.</p><h2 class="fs-6 fw-300" id="viewing-the-schema"> <a href="#viewing-the-schema" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Viewing the schema</h2><p>If you click on the schema tab, you’ll be able to peruse the object types and predicates which are available to you in any database which uses a schema.</p><p>[image here]</p><p>There are several tabs, Classes, Properties, Graphs, Triples and Prefixes. The Triples tab will give you access to the raw OWL schema information, which is also editable.</p><p>[image here]</p><p>But for our purposes we just need to know what properties are available. Here we can see that <code class="highlighter-rouge">scm:start_station</code> and <code class="highlighter-rouge">scm:end_station</code> have a <code class="highlighter-rouge">scm:Journey</code> as the domain, and <code class="highlighter-rouge">scm:Station</code> as a range. This means that our journey object specifies where we started and where we end up.</p><h2 class="fs-6 fw-300" id="combining-queries"> <a href="#combining-queries" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Combining Queries</h2><p>The basic building block of a query in TerminusDB is the triple. In order to combine them we tend to build up graph fragments in which we use the same variable at each node that we want to be the same. We then combine these triples with <code class="highlighter-rouge">and</code>. We call this repeated variable use for matching <em>unification</em>.</p><p>Let’s look at our <code class="highlighter-rouge">scm:Journey</code>’s using <code class="highlighter-rouge">and</code>:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">journey</span><span class="p">,</span><span class="nx">start_station</span><span class="p">,</span><span class="nx">end_station</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">journey</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">start_station</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">end_station</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">and</span><span class="p">(</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span><span class="dl">'</span><span class="s1">scm:start_station</span><span class="dl">'</span><span class="p">,</span><span class="nx">start_station</span><span class="p">)</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span><span class="dl">'</span><span class="s1">scm:end_station</span><span class="dl">'</span><span class="p">,</span><span class="nx">end_station</span><span class="p">)</span>
      <span class="p">)</span>
</code></pre></div></div><p>This query gives us back the end points of our journey. However, it isn’t terribly informative as we are only given identifiers (IRIs) which are opaque. We can however, expand the query to ask for the names of these stations:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">journey</span><span class="p">,</span> <span class="nx">journey_name</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">journey</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">journey_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">start_station</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">start_station</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">start_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">end_station</span><span class="p">,</span> <span class="nx">end_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">end_station</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">end_name</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">and</span><span class="p">(</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span><span class="dl">'</span><span class="s1">scm:start_station</span><span class="dl">'</span><span class="p">,</span><span class="nx">start_station</span><span class="p">),</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">journey_name</span><span class="p">),</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">start_station</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">),</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span><span class="dl">'</span><span class="s1">scm:end_station</span><span class="dl">'</span><span class="p">,</span><span class="nx">end_station</span><span class="p">),</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">end_station</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">end_name</span><span class="p">)</span>
      <span class="p">)</span>
</code></pre></div></div><p>Perfect! Now we see the named location of these bike stations. However, we also have a fair bit of extra information so we can filter that out again with a <code class="highlighter-rouge">select</code> statement.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">journey</span><span class="p">,</span> <span class="nx">journey_name</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">journey</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">journey_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">start_station</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">start_station</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">start_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">end_station</span><span class="p">,</span> <span class="nx">end_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">end_station</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">end_name</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="nx">journey_name</span><span class="p">,</span><span class="nx">start_name</span><span class="p">,</span><span class="nx">end_name</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">and</span><span class="p">(</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span><span class="dl">'</span><span class="s1">scm:start_station</span><span class="dl">'</span><span class="p">,</span><span class="nx">start_station</span><span class="p">),</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">journey_name</span><span class="p">),</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">start_station</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">),</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span><span class="dl">'</span><span class="s1">scm:end_station</span><span class="dl">'</span><span class="p">,</span><span class="nx">end_station</span><span class="p">),</span>
        <span class="nx">triple</span><span class="p">(</span><span class="nx">end_station</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">end_name</span><span class="p">)</span>
      <span class="p">)</span>
</code></pre></div></div><p>Now we have something a little bit more human readable. Perhaps you can try looking at the properties and adding additional information.</p><p>We can also ask questions where we want either/or type results. For this, we can use the WOQL word <code class="highlighter-rouge">or</code>. We could ask, for instance, for every journey which started from a station <em>or</em> ended at that station as follows:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">journey</span><span class="p">,</span> <span class="nx">journey_name</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">journey</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">journey_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">some_station</span><span class="p">,</span> <span class="nx">some_station_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">some_station</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">some_station_name</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="nx">select</span><span class="p">(</span><span class="nx">journey_name</span><span class="p">,</span><span class="nx">some_station_name</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">and</span><span class="p">(</span>
          <span class="nx">or</span><span class="p">(</span>
            <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span><span class="dl">'</span><span class="s1">scm:start_station</span><span class="dl">'</span><span class="p">,</span><span class="nx">some_station</span><span class="p">),</span>
            <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span><span class="dl">'</span><span class="s1">scm:end_station</span><span class="dl">'</span><span class="p">,</span><span class="nx">some_station</span><span class="p">)</span>
          <span class="p">),</span>
          <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">journey_name</span><span class="p">),</span>
          <span class="nx">triple</span><span class="p">(</span><span class="nx">some_station</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">some_station_name</span><span class="p">)</span>
      <span class="p">)</span>
</code></pre></div></div><p>This gives us back journeys which have to do with a station either entering or leaving.</p><h2 class="fs-6 fw-300" id="manipulating-text"> <a href="#manipulating-text" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Manipulating text</h2><p>When you’re querying you’ll often need to manipulate the text in entries. WOQL has a number of words for helping you parse and reassemble text.</p><p>One of the most flexible ways of finding and parsing text is to use the <code class="highlighter-rouge">re</code> WOQL word. Supposing we want to find every journey starting from a station on 10th street. We could run the following:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">journey</span><span class="p">,</span> <span class="nx">journey_name</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">journey</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">journey_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">start_station</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">start_station</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">start_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">match</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">match</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">and</span><span class="p">(</span>
    <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span> <span class="dl">"</span><span class="s2">scm:start_station</span><span class="dl">"</span><span class="p">,</span> <span class="nx">start_station</span><span class="p">),</span>
    <span class="nx">triple</span><span class="p">(</span><span class="nx">start_station</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">),</span>
    <span class="nx">re</span><span class="p">(</span><span class="dl">"</span><span class="s2">.*10th.*</span><span class="dl">"</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">,</span> <span class="p">[</span><span class="nx">match</span><span class="p">])</span>
  <span class="p">)</span>
</code></pre></div></div><p>This is great, but perhaps we want to say what the other corner street was. We can do this by adding matching groups with <code class="highlighter-rouge">(</code> and <code class="highlighter-rouge">)</code>:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">journey</span><span class="p">,</span> <span class="nx">journey_name</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">journey</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">journey_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">start_station</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">start_station</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">start_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">match</span><span class="p">,</span><span class="nx">other</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">match</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">other</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">and</span><span class="p">(</span>
    <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span> <span class="dl">"</span><span class="s2">scm:start_station</span><span class="dl">"</span><span class="p">,</span> <span class="nx">start_station</span><span class="p">),</span>
    <span class="nx">triple</span><span class="p">(</span><span class="nx">start_station</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">),</span>
    <span class="nx">or</span><span class="p">(</span>
      <span class="nx">re</span><span class="p">(</span><span class="dl">"</span><span class="s2">^(.*) . 10th.*$</span><span class="dl">"</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">,</span> <span class="p">[</span><span class="nx">match</span><span class="p">,</span> <span class="nx">other</span><span class="p">]),</span>
      <span class="nx">re</span><span class="p">(</span><span class="dl">"</span><span class="s2">^10th . (.*)$</span><span class="dl">"</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">,</span> <span class="p">[</span><span class="nx">match</span><span class="p">,</span> <span class="nx">other</span><span class="p">])</span>
    <span class="p">)</span>
  <span class="p">)</span>
</code></pre></div></div><p>This gives us back every journey which started at any station on 10th street.</p><p>Once we have these strings, we might want to use them to put together new strings. Let’s add a message to our report about 10th street.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">journey</span><span class="p">,</span> <span class="nx">journey_name</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">journey</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">journey_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">start_station</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">start_station</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">start_name</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">match</span><span class="p">,</span><span class="nx">other</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">match</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">other</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">message</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">select</span><span class="p">(</span><span class="nx">message</span><span class="p">).</span><span class="nx">distinct</span><span class="p">(</span><span class="nx">message</span><span class="p">).</span><span class="nx">and</span><span class="p">(</span>
    <span class="nx">triple</span><span class="p">(</span><span class="nx">journey</span><span class="p">,</span> <span class="dl">"</span><span class="s2">scm:start_station</span><span class="dl">"</span><span class="p">,</span> <span class="nx">start_station</span><span class="p">),</span>
    <span class="nx">triple</span><span class="p">(</span><span class="nx">start_station</span><span class="p">,</span> <span class="dl">'</span><span class="s1">label</span><span class="dl">'</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">),</span>
    <span class="nx">or</span><span class="p">(</span>
      <span class="nx">re</span><span class="p">(</span><span class="dl">"</span><span class="s2">^(.*) . 10th.*$</span><span class="dl">"</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">,</span> <span class="p">[</span><span class="nx">match</span><span class="p">,</span> <span class="nx">other</span><span class="p">]),</span>
      <span class="nx">re</span><span class="p">(</span><span class="dl">"</span><span class="s2">^10th . (.*)$</span><span class="dl">"</span><span class="p">,</span> <span class="nx">start_name</span><span class="p">,</span> <span class="p">[</span><span class="nx">match</span><span class="p">,</span> <span class="nx">other</span><span class="p">])</span>
    <span class="p">),</span>
    <span class="nx">concat</span><span class="p">([</span><span class="dl">"</span><span class="s2">The other street is: </span><span class="dl">"</span><span class="p">,</span><span class="nx">other</span><span class="p">],</span> <span class="nx">message</span><span class="p">)</span>
  <span class="p">)</span>
</code></pre></div></div><p>The use of distinct here gives us a nice summary view, along with your message.</p><h2 class="fs-6 fw-300" id="mathematics"> <a href="#mathematics" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Mathematics</h2><p>You may also want to perform some mathematical operations on data going into or out of the database. WOQL has basic mathematical expressions: <code class="highlighter-rouge">plus</code>, <code class="highlighter-rouge">multiply</code>, <code class="highlighter-rouge">divide</code>, <code class="highlighter-rouge">exp</code>, <code class="highlighter-rouge">div</code> (for integer division) and others. To use them you need to put the mathematical expression in a form called <code class="highlighter-rouge">WOQL.eval</code> as follows:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span> <span class="nx">x</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">x</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">WOQL</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">plus</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nx">x</span><span class="p">)</span>
</code></pre></div></div><p>This binds <code class="highlighter-rouge">x</code> to the result of the addition of <code class="highlighter-rouge">1</code> and <code class="highlighter-rouge">2</code>. You can use variables in place of <code class="highlighter-rouge">1</code> and <code class="highlighter-rouge">2</code> and re-use <code class="highlighter-rouge">x</code> in later queries. For instance we could write:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="p">[</span><span class="nx">product</span><span class="p">,</span><span class="nx">result</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vars</span><span class="p">(</span><span class="dl">'</span><span class="s1">product</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">result</span><span class="dl">'</span><span class="p">)</span>
<span class="nx">and</span><span class="p">(</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">times</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nx">product</span><span class="p">),</span>
    <span class="nx">WOQL</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="nx">div</span><span class="p">(</span><span class="nx">product</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="nx">result</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div><p>Here of course we get back the number <code class="highlighter-rouge">3</code> as we’d expect. The complete definition of mathematical operators is in the python-client reference documentation.</p><h2 id="manipulate-data"> <a href="#manipulate-data" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Manipulate Data</h2><p>WOQL has various ways to manipulate data, which you can do from the console query page. Since in TerminusDB all changes are append-only, this will create a new commit describing all the additions and removals your query did.</p><p>When manipulating data from the query screen, you need to specify a reason for your update in the text bar at the top of the query pane. This message will be used as the commit message.</p><h3 id="inserting"> <a href="#inserting" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Inserting</h3><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:a</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">scm:b</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">doc:c</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div><p>This will insert the triple <code class="highlighter-rouge">("doc:a","scm:b","doc:c")</code>.</p><h3 id="deleting"> <a href="#deleting" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Deleting</h3><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">delete_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:a</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">scm:b</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">doc:c</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div><p>This will delete the triple <code class="highlighter-rouge">("doc:a","scm:b","doc:c")</code>.</p><h2 id="conclusion"> <a href="#conclusion" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Conclusion</h2><p>Now you’ve a few tricks under your belt, you should be able to explore some of the datasets available on TerminusHub or your own data a bit. Happy WOQLing!</p><hr><footer role="contentinfo"><p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 - TerminusDB | Distributed by an <a href="https://github.com/terminusdb/terminusdb-server/blob/master/LICENSE">GPL-3.0 license.</a></p></footer></div></div></div></div><script> var o = document.querySelector(".header"), i = document.querySelector(".menu__body"), a = document.querySelector("#burger"); a && a.addEventListener("click", function () { a.classList.toggle("active"), o.classList.toggle("active"), i.classList.toggle("active"); }); window.addEventListener('resize',function(){ a.classList.remove("active"), o.classList.remove("active"), i.classList.remove("active"); }) </script>
