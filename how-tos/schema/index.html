<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><title>Create Schema - TerminusDB Documentation</title><link rel="shortcut icon" href="/docs/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/docs/assets/css/just-the-docs.css"><link href="https://fonts.googleapis.com/css?family=Lexend+Deca&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Poppins&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.9/css/all.css" integrity="sha384-5SOiIsAziJl6AWe0HWRKTXlfcSHKmYV4RBF18PPJ173Kzn7jzMyFuTtk8JA7QQG1" crossorigin="anonymous"> <script type="text/javascript" src="/docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/docs/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Create Schema | TerminusDB Documentation</title><meta name="generator" content="Jekyll v3.8.7" /><meta property="og:title" content="Create Schema" /><meta property="og:locale" content="en_US" /><meta name="description" content="Documentation for TerminusDB" /><meta property="og:description" content="Documentation for TerminusDB" /><link rel="canonical" href="/docs/how-tos/schema/" /><meta property="og:url" content="/docs/how-tos/schema/" /><meta property="og:site_name" content="TerminusDB Documentation" /> <script type="application/ld+json"> {"description":"Documentation for TerminusDB","@type":"WebPage","url":"/docs/how-tos/schema/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://terminusdb.com/img/logos/logo.svg"}},"headline":"Create Schema","@context":"https://schema.org"}</script> <script async defer src="https://scripts.simpleanalyticscdn.com/latest.js"></script> <noscript><img src="https://queue.simpleanalyticscdn.com/noscript.gif" alt=""/></noscript> <script> var _paq = window._paq || []; /* tracker methods like "setCustomDimension" should be called before "trackPageView" */ _paq.push(['disableCookies']); _paq.push(['trackPageView']); _paq.push(['enableLinkTracking']); (function() { var u="https://terminusdb.matomo.cloud/"; _paq.push(['setTrackerUrl', u+'matomo.php']); _paq.push(['setSiteId', '1']); var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript'; g.async=true; g.defer=true; g.src='//cdn.matomo.cloud/terminusdb.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s); })(); </script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"><title>Link</title><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg><div class="page-wrap"><div class="side-bar"><div class="site-header"> <a href="https://terminusdb.com/documentation" class="site-title lh-tight"><div class="site-logo"></div></a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button></div><div class="navigation main-nav js-main-nav"><nav role="navigation" aria-label="Main navigation"><ul class="navigation-list"><li class="navigation-list-item active"> <a href="https://terminusdb.com/documentation" class="navigation-list-link active">Home</a><li class="navigation-list-item active"><li class="navigation-list-item"><a href="/docs/quickstart/" class="navigation-list-link">Quickstart Academy</a><li class="navigation-list-item"><a href="/docs/tutorials" class="navigation-list-link">Tutorials</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/tutorials/clone-tutorial/" class="navigation-list-link">My First Cloned Database</a><li class="navigation-list-item "><a href="/docs/tutorials/share-tutorial/" class="navigation-list-link">My First Shared Database</a><li class="navigation-list-item "><a href="/docs/tutorials/push-pull-tutorial/" class="navigation-list-link">Pushing and Pulling Changes</a><li class="navigation-list-item "><a href="/docs/tutorials/branch-tutorial/" class="navigation-list-link">Creating and Merging Branches</a><li class="navigation-list-item "><a href="/docs/tutorials/knowledge-graph/" class="navigation-list-link">Taking TerminusDB to the Bank</a><li class="navigation-list-item "><a href="/docs/tutorials/csv-tutorial/" class="navigation-list-link">Importing and Cleaning Data From CSVs</a></ul><li class="navigation-list-item"><a href="/docs/reference/" class="navigation-list-link">Reference</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/reference/server" class="navigation-list-link">Server</a><li class="navigation-list-item "><a href="/docs/reference/js-client/" class="navigation-list-link">JS Client</a><li class="navigation-list-item "><a href="/docs/reference/python-client/" class="navigation-list-link">Python Client</a><li class="navigation-list-item "><a href="/docs/reference/bootstrap" class="navigation-list-link">Bootstrap</a><li class="navigation-list-item "><a href="/docs/reference/web-components" class="navigation-list-link">Console</a><li class="navigation-list-item "><a href="/docs/reference/woql" class="navigation-list-link">WOQL.js - the Definitive Guide</a></ul><li class="navigation-list-item active"><a href="/docs/how-tos" class="navigation-list-link">How Tos</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/how-tos/installation/" class="navigation-list-link">Installation</a><li class="navigation-list-item "><a href="/docs/how-tos/other-install/" class="navigation-list-link">Other ways of installing TerminusDB</a><li class="navigation-list-item "><a href="/docs/how-tos/manage-collaborators/" class="navigation-list-link">Manage Collaborators</a><li class="navigation-list-item "><a href="/docs/how-tos/synchronise/" class="navigation-list-link">Synchronising Changes</a><li class="navigation-list-item "><a href="/docs/how-tos/time-travel/" class="navigation-list-link">Time Travel</a><li class="navigation-list-item "><a href="/docs/how-tos/branch/" class="navigation-list-link">Create and Merge Branches</a><li class="navigation-list-item "><a href="/docs/how-tos/import-data/" class="navigation-list-link">Import and Clean CSV Data</a><li class="navigation-list-item "><a href="/docs/how-tos/query/" class="navigation-list-link">Query</a><li class="navigation-list-item active"><a href="/docs/how-tos/schema/" class="navigation-list-link active">Create Schema</a><li class="navigation-list-item "><a href="/docs/how-tos/python" class="navigation-list-link">Python How Tos</a><li class="navigation-list-item "><a href="/docs/how-tos/beta/" class="navigation-list-link">Accessing TerminusHub with Bootstrap - Certificate Help</a></ul><li class="navigation-list-item"><a href="/docs/discussion" class="navigation-list-link">Discussion</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/discussion/baisc/" class="navigation-list-link">Basic Ideas</a><li class="navigation-list-item "><a href="/docs/discussion/collaboration/" class="navigation-list-link">Collaboration</a><li class="navigation-list-item "><a href="/docs/discussion/branch/" class="navigation-list-link">Branching and Merging</a><li class="navigation-list-item "><a href="/docs/discussion/storage/" class="navigation-list-link">Storage</a><li class="navigation-list-item "><a href="/docs/discussion/data-model/" class="navigation-list-link">Data Modeling</a><li class="navigation-list-item "><a href="/docs/discussion/query/" class="navigation-list-link">Querying</a><li class="navigation-list-item "><a href="/docs/discussion/reserach/" class="navigation-list-link">Research Papers</a></ul><li class="navigation-list-item"><a href="/docs/release-notes/" class="navigation-list-link">Release notes</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="/docs/release-notes/upgrade/" class="navigation-list-link">Upgrade</a></ul><li class="navigation-list-item"><a href="/docs/frequently-asked-questions/" class="navigation-list-link">FAQs</a></ul></nav></div><footer class="site-footer"><p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p></footer></div><div class="main-content-wrap js-main-content" tabindex="0"><div class="main-content"><header class="header header--dark"><div class="wrapper wrapper--increased"><nav class="menu"><div class="menu__body"><ul class="menu__list"><li class="menu__item"> <a href="https://terminusdb.com/docs/" target="_self" class="menu__link menu__link--active" aria-label="Documentation"> Documentation </a><li class="menu__item"> <a href="https://terminusdb.com/community/" target="_self" class="menu__link " aria-label="Community"> Community </a><li class="menu__item"> <a href="https://terminusdb.com/blog/" target="_self" class="menu__link" aria-label="Blog"> Blog </a><li class="menu__item"> <a href="https://terminusdb.com/hub/" target="_self" class="menu__link" aria-label="Blog"> Terminus Hub </a><li class="menu__item menu__item--full-devices"><ul class="menu__social-list"><li class="menu__social-item"> <a href="https://twitter.com/TerminusDB" class="menu__social-link" target="_blank"> <i class="icon-twitter menu__icon"></i> </a><li class="menu__social-item"> <a href="https://github.com/terminusdb/terminusdb-server" class="menu__social-link" target="_blank" aria-label="Github link"> <i class="icon-github-logo menu__icon"></i> </a><li class="menu__social-item"><a href="https://www.youtube.com/channel/UC5kZt8pP-FM0u-R0BQr78YA/featured" class="menu__social-link" target="_blank"><i class="icon-youtube menu__icon"></i></a><li class="menu__social-item"><a href="https://www.linkedin.com/company/terminusdb/" class="menu__social-link" target="_blank"><i class="icon-linkedin menu__icon"></i></a></ul><li class="menu__item menu__item--full-devices"> <a href="https://terminusdb.com/hub/download" target="_self" class="menu__button" aria-label="Download center"> Download Center </a></ul><ul class="menu__footer"><li class="menu__secondary-item"> <a href="https://terminusdb.com" role="button"> <img src="https://terminusdb.com/img/logos/logo.svg" class="menu__secondary-logo" alt="Terminus DB logo"> </a><li class="menu__secondary-item"><p class="menu__copyright"> ©2020 - TerminusDB | All right reserved</p></ul></div><button id="burger" class="menu__burger" role="button" aria-label="Navigation burger button"> <span></span> <span></span> <span></span> </button></nav></div></header><div class="page-header js-page-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search TerminusDB Documentation" aria-label="Search TerminusDB Documentation" autocomplete="off"> <label for="search-input" class="search-label"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </label></div><div id="search-results" class="search-results"></div></div><ul class="list-style-none text-small aux-nav"><li class="d-inline-block my-0"><a href="https://terminusdb.com">TerminusDB Homepage</a></ul></div><div class="page"><nav class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/docs/how-tos">How Tos</a><li class="breadcrumb-nav-list-item"><span>Create Schema</span></ol></nav><div id="main-content" class="page-content" role="main"><h1 class="no_toc" id="create-schema"> <a href="#create-schema" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Create Schema</h1><h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Table of contents</h2><ol id="markdown-toc"><li><a href="#creating-a-schema" id="markdown-toc-creating-a-schema">Creating a Schema</a><li><a href="#graph-schemas" id="markdown-toc-graph-schemas">Graph Schemas</a><li><a href="#cardinality" id="markdown-toc-cardinality">Cardinality</a><li><a href="#schema-migration" id="markdown-toc-schema-migration">Schema migration</a><li><a href="#creating-hierarchies" id="markdown-toc-creating-hierarchies">Creating hierarchies</a></ol><hr /><h2 id="creating-a-schema"> <a href="#creating-a-schema" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Creating a Schema</h2><p>The easiest way to create a schema in TerminusDB is by using a WOQL query.</p><p>First thing, you should create a database in which to put the schema. You can do this through the console.</p><p>Our schema is comprised of classes and properties. WOQL will allow us to construct them with the <code class="highlighter-rouge">WOQL.doctype</code> keyword.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">doctype</span><span class="p">(</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">A Person with person-like properties</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">surname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:integer</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div><p>This object has 3 properties, with three different datatypes. It is essentially a simple record.</p><p>The data which can be put into this object should look something like the following:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">scm:Person</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">surname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Martin</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">,</span> <span class="mi">38</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div><p>This query will insert a valid record for our class above. As you can see we are only pointing at datapoints at the moment, but we can also have properties point to other objects.</p><h2 id="graph-schemas"> <a href="#graph-schemas" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Graph Schemas</h2><p>We can go ahead and modify the previous query by adding a <code class="highlighter-rouge">scm:friends_with</code> field. As long as we’re only adding things, there is no problem repeating assertions we’ve already made. So we’ll just copy the person from above and try again.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">doctype</span><span class="p">(</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">A Person with person-like properties</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">surname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:integer</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">friends_with</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div><p>You can go ahead and go to the Schema button at the top, and you’ll see that there is still only one Person class. All we did is suggest that the “friends_with” property should be added.</p><p>Now we can add a couple of people and have them point to each other.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sarah_cohen</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">scm:Person</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sarah_cohen</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Sara</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sarah_cohen</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">surname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Cohen</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sarah_cohen</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">,</span> <span class="mi">42</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sarah_cohen</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">friends_with</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">friends_with</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">doc:sarah_cohen</span><span class="dl">"</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div><p>Our schema as designed allows us to control the types of fields. We can see this by trying to put in some data which is not correct according to the schema.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sarah_cohen</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div><p>This gives us a predictable error that jim is not a string.</p><p>However, as <code class="highlighter-rouge">scm:Person</code> is currently written we do not constraint the <em>number</em> of times a property is used. For instance we can write:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">scm:Person</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">James</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">surname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Martin</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">,</span> <span class="mi">38</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div><h2 id="cardinality"> <a href="#cardinality" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Cardinality</h2><p>Jim now has two names. Maybe we want this, but perhaps we want a formal legal forename, and we constraint his aliases to something called <code class="highlighter-rouge">scm:nick</code> for instance.</p><p>Let’s rewrite our person to add cardinality restrictions on the properties.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">doctype</span><span class="p">(</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">A Person with person-like properties</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">).</span><span class="nx">cardinality</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">surname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">).</span><span class="nx">cardinality</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">nickname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:integer</span><span class="dl">"</span><span class="p">).</span><span class="nx">cardinality</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">friends_with</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div><p>Now we have an unconstrained “scm:friends_with” relationship and any number of nicknames on the “scm:nickname” property but we can only have one of each of the other properties.</p><h2 id="schema-migration"> <a href="#schema-migration" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Schema migration</h2><p>Unfortunately, this query results in an error because we have data already in our system which does not conform to our schema changes. We need to alter the data to make it conform. We can simply remove the offending forename in the same stroke that we add the schema change.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">delete_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">James</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">doctype</span><span class="p">(</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">A Person with person-like properties</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">).</span><span class="nx">cardinality</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">surname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">).</span><span class="nx">cardinality</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">nickname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:string</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">xsd:integer</span><span class="dl">"</span><span class="p">).</span><span class="nx">cardinality</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">friends_with</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div><p>Now we have added cardinality and removed the violation in a single transaction.</p><h2 id="creating-hierarchies"> <a href="#creating-hierarchies" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Creating hierarchies</h2><p>So far, we have a very flat structure. Let’s add a subclass for <code class="highlighter-rouge">scm:Person</code> called <code class="highlighter-rouge">scm:Doctor</code>.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">doctype</span><span class="p">(</span><span class="dl">"</span><span class="s2">Doctor</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">parent</span><span class="p">(</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">label</span><span class="p">(</span><span class="dl">"</span><span class="s2">Doctor</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">description</span><span class="p">(</span><span class="dl">"</span><span class="s2">A Doctor is a person with patients</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">property</span><span class="p">(</span><span class="dl">"</span><span class="s2">patient</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div><p>A doctor shares all of the properties available to a Person, but it also has a patient. Let us add a Doctor.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">WOQL</span><span class="p">.</span><span class="nx">and</span><span class="p">(</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sigmund_freud</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">scm:Doctor</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sigmund_freud</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">forename</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Freud</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sigmund_freud</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">surname</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Sigmund</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sigmund_freud</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sarah_cohen</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">friends_with</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">doc:sigmund_freud</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sigmund_freud</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">friends_with</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">doc:sarah_cohen</span><span class="dl">"</span><span class="p">),</span>
  <span class="nx">WOQL</span><span class="p">.</span><span class="nx">add_triple</span><span class="p">(</span><span class="dl">"</span><span class="s2">doc:sigmund_freud</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">patient</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">doc:jim_martin</span><span class="dl">"</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div><p>This saved us a lot of time as we factored out the joint qualities of a person first. You can make any sort of hierarchy without worrying about multiple inheritence restrictions that often occur in other systems.</p><p>Good luck schema-writing!</p><hr><footer role="contentinfo"><p class="text-small text-grey-dk-000 mb-0">Copyright &copy; 2020 - TerminusDB | Distributed by an <a href="https://github.com/terminusdb/terminusdb-server/blob/master/LICENSE">GPL-3.0 license.</a></p></footer></div></div></div></div><script> var o = document.querySelector(".header"), i = document.querySelector(".menu__body"), a = document.querySelector("#burger"); a && a.addEventListener("click", function () { a.classList.toggle("active"), o.classList.toggle("active"), i.classList.toggle("active"); }); window.addEventListener('resize',function(){ a.classList.remove("active"), o.classList.remove("active"), i.classList.remove("active"); }) </script>
